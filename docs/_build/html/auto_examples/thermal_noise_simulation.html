
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Thermal noise computation &#8212; bfieldtools 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MAMBA coil" href="mamba_coil_design.html" />
    <link rel="prev" title="Interpolate stream function" href="interpolate_example.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>bfieldtools 0.1 documentation</span></a></h1>
        <h2 class="heading"><span>Thermal noise computation</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="interpolate_example.html">Interpolate stream function</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="mamba_coil_design.html">MAMBA coil</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-thermal-noise-simulation-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="thermal-noise-computation">
<span id="sphx-glr-auto-examples-thermal-noise-simulation-py"></span><h1>Thermal noise computation<a class="headerlink" href="#thermal-noise-computation" title="Permalink to this headline">¶</a></h1>
<dl class="simple">
<dt>Three different examples:</dt><dd><p>unit_sphere: DC Bnoise of a spherical shell at origin and comparison to analytical formula
unit_disc: DC Bnoise of a unit disc at z-axis and comparison to analytical formula
AC: AC Bnoise of a unit disc at one position</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">trimesh</span>

<span class="kn">from</span> <span class="nn">bfieldtools.thermal_noise</span> <span class="k">import</span> <span class="n">compute_current_modes</span><span class="p">,</span> <span class="n">visualize_current_modes</span><span class="p">,</span> <span class="n">compute_dc_Bnoise</span><span class="p">,</span> <span class="n">compute_ac_Bnoise</span>

<span class="kn">import</span> <span class="nn">pkg_resources</span>



<span class="c1">#Fix the simulation parameters</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">100e-6</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.7e7</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">kB</span> <span class="o">=</span> <span class="mf">1.38064852e-23</span>
<span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span>
</pre></div>
</div>
<div class="section" id="unit-sphere">
<h2>Unit sphere<a class="headerlink" href="#unit-sphere" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Np</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">)</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Np</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Np</span><span class="p">):</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;bfieldtools&#39;</span><span class="p">,</span> <span class="s1">&#39;example_meshes/unit_sphere.stl&#39;</span><span class="p">))</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">apply_scale</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">vl</span> <span class="o">=</span> <span class="n">compute_current_modes</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

    <span class="n">vl</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">vl</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># fix DC-component</span>


    <span class="n">Btemp</span> <span class="o">=</span> <span class="n">compute_dc_Bnoise</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span><span class="n">vl</span><span class="p">,</span><span class="n">fp</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
    <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Btemp</span>

<span class="n">visualize_current_modes</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span><span class="n">vl</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">Ban</span> <span class="o">=</span> <span class="n">mu0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="n">kB</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Ban</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Numerical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sphere radius&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;DC noise Bz (T/rHz)&#39;</span><span class="p">)</span>

<span class="n">RE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">B</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">Ban</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ban</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">B</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">Ban</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ban</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sphere radius&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative error (%)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../_images/sphx_glr_thermal_noise_simulation_001.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_thermal_noise_simulation_001.png" />
</li>
<li><img alt="../_images/sphx_glr_thermal_noise_simulation_002.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_thermal_noise_simulation_002.png" />
</li>
</ul>
<img alt="../_images/sphx_glr_thermal_noise_simulation_003.png" class="sphx-glr-single-img" src="../_images/sphx_glr_thermal_noise_simulation_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rzetter/Documents/bfieldtools/bfieldtools/thermal_noise.py:46: RuntimeWarning: invalid value encountered in sqrt
  vl[inner_verts, i] = v[:, i]/np.sqrt(u[i])
Computing C matrix, 2562 vertices by 1 target points... took 0.10 seconds.
/home/rzetter/Documents/bfieldtools/bfieldtools/thermal_noise.py:46: RuntimeWarning: invalid value encountered in sqrt
  vl[inner_verts, i] = v[:, i]/np.sqrt(u[i])
Computing C matrix, 2562 vertices by 1 target points... took 0.10 seconds.
/home/rzetter/Documents/bfieldtools/bfieldtools/thermal_noise.py:46: RuntimeWarning: invalid value encountered in sqrt
  vl[inner_verts, i] = v[:, i]/np.sqrt(u[i])
Computing C matrix, 2562 vertices by 1 target points... took 0.10 seconds.
/home/rzetter/Documents/bfieldtools/bfieldtools/thermal_noise.py:46: RuntimeWarning: invalid value encountered in sqrt
  vl[inner_verts, i] = v[:, i]/np.sqrt(u[i])
Computing C matrix, 2562 vertices by 1 target points... took 0.10 seconds.
Computing C matrix, 2562 vertices by 1 target points... took 0.10 seconds.
/home/rzetter/Documents/bfieldtools/bfieldtools/thermal_noise.py:46: RuntimeWarning: invalid value encountered in sqrt
  vl[inner_verts, i] = v[:, i]/np.sqrt(u[i])
Computing C matrix, 2562 vertices by 1 target points... took 0.10 seconds.
/home/rzetter/Documents/bfieldtools/bfieldtools/thermal_noise.py:46: RuntimeWarning: invalid value encountered in sqrt
  vl[inner_verts, i] = v[:, i]/np.sqrt(u[i])
Computing C matrix, 2562 vertices by 1 target points... took 0.10 seconds.
/home/rzetter/Documents/bfieldtools/bfieldtools/thermal_noise.py:46: RuntimeWarning: invalid value encountered in sqrt
  vl[inner_verts, i] = v[:, i]/np.sqrt(u[i])
Computing C matrix, 2562 vertices by 1 target points... took 0.11 seconds.
Computing C matrix, 2562 vertices by 1 target points... took 0.10 seconds.
Computing C matrix, 2562 vertices by 1 target points... took 0.11 seconds.
</pre></div>
</div>
</div>
<div class="section" id="unit-disc-dc-noise">
<h2>Unit disc, DC noise<a class="headerlink" href="#unit-disc-dc-noise" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mesh</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;bfieldtools&#39;</span><span class="p">,</span> <span class="s1">&#39;example_meshes/unit_disc.stl&#39;</span><span class="p">))</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">remesh</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">remesh</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>

<span class="n">vl</span> <span class="o">=</span> <span class="n">compute_current_modes</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>


<span class="n">visualize_current_modes</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span><span class="n">vl</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">Np</span> <span class="o">=</span> <span class="mi">30</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">)</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">compute_dc_Bnoise</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span><span class="n">vl</span><span class="p">,</span><span class="n">fp</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Ban</span> <span class="o">=</span> <span class="n">mu0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="n">kB</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">Ban</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">B</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Numerical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance d/R&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;DC noise Bz (T/rHz)&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">B</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">Ban</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ban</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance d/R&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative error (%)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../_images/sphx_glr_thermal_noise_simulation_004.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_thermal_noise_simulation_004.png" />
</li>
<li><img alt="../_images/sphx_glr_thermal_noise_simulation_005.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_thermal_noise_simulation_005.png" />
</li>
</ul>
<img alt="../_images/sphx_glr_thermal_noise_simulation_006.png" class="sphx-glr-single-img" src="../_images/sphx_glr_thermal_noise_simulation_006.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing C matrix, 1207 vertices by 30 target points... took 0.07 seconds.
</pre></div>
</div>
</div>
<div class="section" id="unit-disc-ac-mode">
<h2>Unit disc, AC mode<a class="headerlink" href="#unit-disc-ac-mode" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mesh</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;bfieldtools&#39;</span><span class="p">,</span> <span class="s1">&#39;example_meshes/unit_disc.stl&#39;</span><span class="p">))</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">remesh</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">remesh</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>

<span class="n">vl</span> <span class="o">=</span> <span class="n">compute_current_modes</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">Nfreqs</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Nfreqs</span><span class="p">)</span> <span class="c1">#30 frequencies from 1 to 1000 Hz</span>

<span class="n">Bf</span> <span class="o">=</span> <span class="n">compute_ac_Bnoise</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span><span class="n">vl</span><span class="p">,</span><span class="n">fp</span><span class="p">,</span><span class="n">freqs</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Ban</span> <span class="o">=</span> <span class="n">mu0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="n">kB</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">fp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span><span class="n">Bf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Numerical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">Ban</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">freqs</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Analytical, DC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Field noise (T/rHz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_thermal_noise_simulation_007.png" class="sphx-glr-single-img" src="../_images/sphx_glr_thermal_noise_simulation_007.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing C matrix, 1207 vertices by 1 target points... took 0.06 seconds.
Calculating potentials, chunk 1/1
Frequency 1.000000 computed
Frequency 1.268961 computed
Frequency 1.610262 computed
Frequency 2.043360 computed
Frequency 2.592944 computed
Frequency 3.290345 computed
Frequency 4.175319 computed
Frequency 5.298317 computed
Frequency 6.723358 computed
Frequency 8.531679 computed
Frequency 10.826367 computed
Frequency 13.738238 computed
Frequency 17.433288 computed
Frequency 22.122163 computed
Frequency 28.072162 computed
Frequency 35.622479 computed
Frequency 45.203537 computed
Frequency 57.361525 computed
Frequency 72.789538 computed
Frequency 92.367086 computed
Frequency 117.210230 computed
Frequency 148.735211 computed
Frequency 188.739182 computed
Frequency 239.502662 computed
Frequency 303.919538 computed
Frequency 385.662042 computed
Frequency 489.390092 computed
Frequency 621.016942 computed
Frequency 788.046282 computed
Frequency 1000.000000 computed
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  13.467 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-thermal-noise-simulation-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/14916049361764c5f9c58b54f5386dab/thermal_noise_simulation.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">thermal_noise_simulation.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/724928980d3dc452dd763eac6ec73b3f/thermal_noise_simulation.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">thermal_noise_simulation.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="interpolate_example.html">Interpolate stream function</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="mamba_coil_design.html">MAMBA coil</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Rasmus Zetter, Antti Mäkinen, Joonas Iivanainen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>